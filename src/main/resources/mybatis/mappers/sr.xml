<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="sr">
	<!-- 쿼리문작성 -->
	<resultMap type="com.javaex.vo.SolClassVo" id="resultMapClassVo">
      <result column="class_no" property="classNo"></result>
      <result column="company_no" property="companyNo"></result>
      <result column="cate1_no" property="cate1No"></result>
      <result column="cate1_name" property="cate1Name"></result>
      <result column="cate2_no" property="cate2No"></result>
      <result column="cate2_name" property="cate2Name"></result>
      <result column="class_name" property="className"></result>
      <result column="class_type" property="classType"></result>
      <result column="class_intro" property="classIntro"></result>
      <result column="class_zipcode" property="classZipcode"></result>
      <result column="class_name_address" property="classNameAddress"></result>
      <result column="class_num_address" property="classNumAddress"></result>
      <result column="class_detail_address" property="classDetailAddress"></result>
      <result column="class_latitude" property="classLatitude"></result>
      <result column="class_longitutde" property="classLongitutde"></result>
      <result column="class_image" property="classImage"></result>
      <result column="class_price" property="classPrice"></result>
      <result column="class_min" property="classMin"></result>
      <result column="class_max" property="classMax"></result>
      <result column="class_info" property="classInfo"></result>
      <result column="class_url" property="classUrl"></result>
      <result column="rec_class_no" property="recClassNo"></result>
   </resultMap>
   <resultMap type="com.javaex.vo.SolCateVo" id="resultMapCateVo">
      <result column="cate1_no" property="cate1No"></result>
      <result column="cate2_no" property="cate2No"></result>
      <result column="cate1_name" property="cate1Name"></result>
      <result column="cate2_name" property="cate2Name"></result>
   </resultMap>
	<!-- <![CDATA[]]> -->
	
	<!-- 사업자 -->
	<!-- 아이디 중복체크 -->
	<select id="companyId" parameterType="string" resultType="string">
	<![CDATA[
		select company_id from company
		where company_id = #{companyid}
	]]> 
	</select>
	
	<!-- 회원가입 -->
	<insert id="companyInsert" parameterType="CompanyVo">
	<![CDATA[
		insert into company 
		values(null, #{companyName}, #{companyId}, #{companyPass}, #{companyBn}, 
		#{companyImage}, 
		#{companyZipCode}, #{companyNameAddress}, #{companyNumAddress}, #{companyDetailAddress}, 
		#{companyLatitude}, #{companyLongitude}, 
		#{companyHp}, #{companyIntro})
	]]>
	</insert>
	
	<!-- 사업자 로그인 -->
	<select id="companyLogin" parameterType="CompanyVo" resultType="CompanyVo">
	<![CDATA[
		select company_no companyNo, company_id companyId, company_pw companyPass
		from company
		where company_id = #{companyId}
		and company_pw = #{companyPass}
	]]>
	</select>
	
	
	
	<!-- 클래스 -->
	<select id="companyClassList" parameterType="map" resultType="classVo">
	<![CDATA[
		select class_no classNo, class_name className
		from class 
		where company_no = #{no}
		and class_type = #{type}
	]]>
	</select>
	
	
	<!-- 클래스 불러오기 -->
	<select id="getClass" parameterType="map" resultType="classVo" resultMap="resultMapClassVo">
	<![CDATA[
	select c.class_no, c.company_no, c.class_name, c.class_intro, 
		c.class_zipcode, c.class_name_address, c.class_num_address, 
		c.cate2_no, t.cate1_no, c.class_type,
		c.class_price, c.class_min, c.class_max,
		c.class_info, c.rec_class_no
	from class c, cate1 t, cate2 t2
	where c.company_no = #{companyNo}
	and c.class_no = #{classNo}
	and c.cate2_no = t2.cate2_no
	and t.cate1_no = t2.cate1_no
	]]>
	</select>
	<!-- 1차 카테고리 불러오기 -->
	<select id="selectAllCate1" resultType="com.javaex.vo.SolCateVo" resultMap="resultMapCateVo">
	<![CDATA[
	select c2.cate1_no, c1.cate1_name
	from cate1 c1, cate2 c2
	where c1.cate1_no=c2.cate1_no
	group by c1.cate1_no
	]]>
	</select>
	<!-- 2차카테고리 불러오기 -->
	<select id="selectCate2" parameterType="int" resultType="com.javaex.vo.SolCateVo">
	<![CDATA[
	select c2.cate2_no, c2.cate2_name
	from cate1 c1, cate2 c2
	where c1.cate1_no=c2.cate1_no
	and c1.cate1_no = #{cate1No}
	]]>
	</select>
	
</mapper>